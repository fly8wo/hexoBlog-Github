language: node_js
node_js: stable

cache:
  directories:
    - node_modules


install:
  - npm install

before_script:
  - git submodule update --remote --merge

script:
  - hexo g && gulp

after_script:
  - cd public
  - git init
  - git config user.name "mtianyan"
  - git config user.email "1147727180@qq.com"
  - git add .
  - git commit -m "Update docs"
  - git push --force --quiet "https://${33ba3948ba6549c992ffe0a6ac4e487088a984be}@${mtianyan.github.io}" master:master

branches:
  only:
    - master
env:
 global:
   - GIT_PAGE_REF: github.com/mtianyan/mtianyan.github.io.git
   - secure: "Pct6dRL7NiwzKnyJ5HOTgFxzL97B9xHP9NuL7h4yhYoLXpW40/Lvm5kNIvxqcuUlPsGkW/Dd8hHINqitHfTskfgCgBY92nErWCBucGk6lqf+S4eSp/t3tp+Dgz+18s2XZE7AyOz12bNL8alpNv5wwvLjLM5Gr0MHp+klcIS7sWxDQq2EmxZbmZltwbb0NQbuEn50Q5vuo5bDuiCh/V+2a7gu151r0n7piwF7PoHpkCckhgIM09i9S0g5SyXcsC+HCF4p2j2ciRTCRIVVdEM3+/2/P1lNItphYZTdLE2EOG7wRMHVn8BtMcKF3PjHURKNN/+dMAdBF0bflgRcEJQmTh2uo+xEvgKq1x731rbypn5KG+rb7TqwfxWifjLdFU23pwZ31oXYgbsGci3SCd3j5gzK30rcCjyEjHnuhzMQBV/XyBVCGuQCcW7MTE1WffhtDwYYt8nBFQOZYv7RBTxk9siGOuc6sJhpE4gsL15teOUr7GymVqwPn9HiSG/iOm5NKFoPC4ht8Gjboq5sdMeahFYwIlXrule8Y76ZEW0vS6rrwhdyjaQa9CDxhKVvRSljvNuCt+QiDgEnWYZyw4keNTb3Hf/fDWoz0FeYRDBD9BITe4fyDt/cblxFhXT3GMf+JypUoxM5BKBjPFoCk4qYNOHza0tYvcm68LS3jZ+tGXw="

# configure notifications (email, IRC, campfire etc)
# please update this section to your needs!
# https://docs.travis-ci.com/user/notifications/
notifications:
  email:
    - 1147727180@qq.com
    - mtianyan@outlook.com
  on_success: change
  on_failure: always

